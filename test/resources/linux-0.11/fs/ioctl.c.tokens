<punctuator, #>
<identifier, include>
<header_name, <string.h>>
<punctuator, #>
<identifier, include>
<header_name, <errno.h>>
<punctuator, #>
<identifier, include>
<header_name, <sys/stat.h>>
<punctuator, #>
<identifier, include>
<header_name, <linux/sched.h>>
<keyword, extern>
<keyword, int>
<identifier, tty_ioctl>
<operator, (>
<keyword, int>
<identifier, dev>
<operator, ,>
<keyword, int>
<identifier, cmd>
<operator, ,>
<keyword, int>
<identifier, arg>
<operator, )>
<punctuator, ;>
<keyword, typedef>
<keyword, int>
<operator, (>
<operator, *>
<identifier, ioctl_ptr>
<operator, )>
<operator, (>
<keyword, int>
<identifier, dev>
<operator, ,>
<keyword, int>
<identifier, cmd>
<operator, ,>
<keyword, int>
<identifier, arg>
<operator, )>
<punctuator, ;>
<operator, #>
<identifier, define>
<identifier, NRDEVS>
<operator, (>
<operator, (>
<keyword, sizeof>
<operator, (>
<identifier, ioctl_table>
<operator, )>
<operator, )>
<operator, />
<operator, (>
<keyword, sizeof>
<operator, (>
<identifier, ioctl_ptr>
<operator, )>
<operator, )>
<operator, )>
<keyword, static>
<identifier, ioctl_ptr>
<identifier, ioctl_table>
<operator, [>
<operator, ]>
<operator, =>
<punctuator, {>
<identifier, NULL>
<operator, ,>
<identifier, NULL>
<operator, ,>
<identifier, NULL>
<operator, ,>
<identifier, NULL>
<operator, ,>
<identifier, tty_ioctl>
<operator, ,>
<identifier, tty_ioctl>
<operator, ,>
<identifier, NULL>
<operator, ,>
<identifier, NULL>
<punctuator, }>
<punctuator, ;>
<keyword, int>
<identifier, sys_ioctl>
<operator, (>
<keyword, unsigned>
<keyword, int>
<identifier, fd>
<operator, ,>
<keyword, unsigned>
<keyword, int>
<identifier, cmd>
<operator, ,>
<keyword, unsigned>
<keyword, long>
<identifier, arg>
<operator, )>
<punctuator, {>
<keyword, struct>
<identifier, file>
<operator, *>
<identifier, filp>
<punctuator, ;>
<keyword, int>
<identifier, dev>
<operator, ,>
<identifier, mode>
<punctuator, ;>
<keyword, if>
<operator, (>
<identifier, fd>
<operator, >>
<operator, =>
<identifier, NR_OPEN>
<operator, |>
<operator, |>
<operator, !>
<operator, (>
<identifier, filp>
<operator, =>
<identifier, current>
<operator, ->>
<identifier, filp>
<operator, [>
<identifier, fd>
<operator, ]>
<operator, )>
<operator, )>
<keyword, return>
<operator, ->
<identifier, EBADF>
<punctuator, ;>
<identifier, mode>
<operator, =>
<identifier, filp>
<operator, ->>
<identifier, f_inode>
<operator, ->>
<identifier, i_mode>
<punctuator, ;>
<keyword, if>
<operator, (>
<operator, !>
<identifier, S_ISCHR>
<operator, (>
<identifier, mode>
<operator, )>
<operator, &>
<operator, &>
<operator, !>
<identifier, S_ISBLK>
<operator, (>
<identifier, mode>
<operator, )>
<operator, )>
<keyword, return>
<operator, ->
<identifier, EINVAL>
<punctuator, ;>
<identifier, dev>
<operator, =>
<identifier, filp>
<operator, ->>
<identifier, f_inode>
<operator, ->>
<identifier, i_zone>
<operator, [>
<integer_constant, 0>
<operator, ]>
<punctuator, ;>
<keyword, if>
<operator, (>
<identifier, MAJOR>
<operator, (>
<identifier, dev>
<operator, )>
<operator, >>
<operator, =>
<identifier, NRDEVS>
<operator, )>
<keyword, return>
<operator, ->
<identifier, ENODEV>
<punctuator, ;>
<keyword, if>
<operator, (>
<operator, !>
<identifier, ioctl_table>
<operator, [>
<identifier, MAJOR>
<operator, (>
<identifier, dev>
<operator, )>
<operator, ]>
<operator, )>
<keyword, return>
<operator, ->
<identifier, ENOTTY>
<punctuator, ;>
<keyword, return>
<identifier, ioctl_table>
<operator, [>
<identifier, MAJOR>
<operator, (>
<identifier, dev>
<operator, )>
<operator, ]>
<operator, (>
<identifier, dev>
<operator, ,>
<identifier, cmd>
<operator, ,>
<identifier, arg>
<operator, )>
<punctuator, ;>
<punctuator, }>
